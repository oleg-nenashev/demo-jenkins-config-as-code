#!/bin/bash -ex
BASEDIR=$(dirname "$0")

MAVEN_SETTINGS_DEFAULT='.mvn/wrapper/settings.xml'
MAVEN_REPOSITORY_DEFAULT=".m2/repository"
WORKSPACE_DEFAULT='../..'
GITHUB_USER_DEFAULT='username'
GITHUB_PWD_DEFAULT='xxxxxx'

if test -v "${MAVEN_REPOSITORY}"; then
    MAVEN_REPOSITORY_DEFAULT="${MAVEN_REPOSITORY}"
fi
if test -v "${GITHUB_USERNAME}"; then
    GITHUB_USER_DEFAULT="${GITHUB_USERNAME}"
fi
if test -v "${GITHUB_PASSWORD}"; then
    GITHUB_PWD_DEFAULT="${GITHUB_PASSWORD}"
fi

MAVEN_SETTINGS="${MAVEN_SETTINGS_DEFAULT}"

WORKSPACE=${1:-${WORKSPACE_DEFAULT}}
export MAVEN_REPOSITORY=${2:-${MAVEN_REPOSITORY_DEFAULT}}
export GITHUB_USERNAME=${3:-${GITHUB_USER_DEFAULT}}
export GITHUB_PASSWORD=${4:-${GITHUB_PWD_DEFAULT}}


echo """
GITHUB_USERNAME: ${GITHUB_USERNAME}
"""

MAVEN_PARAMS="-s ${WORKSPACE}/${MAVEN_SETTINGS} -e"

chmod 777 ${WORKSPACE}/mvnw

runMvnw() {
 GOALS=${1}
 ${WORKSPACE}/mvnw ${GOALS} ${MAVEN_PARAMS}
}
